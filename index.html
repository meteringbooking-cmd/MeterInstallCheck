<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartMeter AI Inspector</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="grain-overlay"></div>
    
    <nav class="top-nav">
        <div class="nav-content">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <rect x="4" y="4" width="24" height="24" stroke="currentColor" stroke-width="2"/>
                    <path d="M16 10L16 22M10 16L22 16" stroke="currentColor" stroke-width="2"/>
                    <circle cx="16" cy="16" r="3" fill="currentColor"/>
                </svg>
                <span>SmartMeter AI</span>
            </div>
            <div class="nav-links">
                <button class="nav-btn active" data-view="inspect">Inspect</button>
                <button class="nav-btn" data-view="train">Training Lab</button>
                <button class="nav-btn" data-view="history">History</button>
            </div>
        </div>
    </nav>

    <main class="container">
        <!-- Inspection View -->
        <section id="inspect-view" class="view active">
            <div class="hero-section">
                <h1 class="glitch" data-text="Installation Inspector">Installation Inspector</h1>
                <p class="subtitle">AI-powered quality assurance for smart meter installations</p>
            </div>

            <div class="upload-zone" id="uploadZone">
                <div class="upload-content">
                    <div class="upload-icon">
                        <svg width="64" height="64" viewBox="0 0 64 64" fill="none">
                            <path d="M32 10L32 40M32 10L22 20M32 10L42 20" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                            <rect x="10" y="45" width="44" height="8" stroke="currentColor" stroke-width="3"/>
                        </svg>
                    </div>
                    <h3>Drop meter installation photo</h3>
                    <p>or click to browse</p>
                    <input type="file" id="fileInput" accept="image/*" hidden>
                </div>
            </div>

            <div class="camera-controls">
                <button class="btn-secondary" id="cameraBtn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="2" y="5" width="16" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <circle cx="10" cy="11" r="3" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M7 5L8 2H12L13 5" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    Use Camera
                </button>
            </div>

            <div class="preview-section" id="previewSection" style="display: none;">
                <div class="preview-container">
                    <img id="previewImage" alt="Preview">
                    <div class="analysis-overlay" id="analysisOverlay"></div>
                </div>
                
                <div class="controls">
                    <button class="btn-primary" id="analyzeBtn">
                        <span class="btn-text">Analyze Installation</span>
                        <span class="btn-loader"></span>
                    </button>
                </div>

                <div class="results" id="results" style="display: none;">
                    <div class="result-header">
                        <div class="status-badge" id="statusBadge"></div>
                        <div class="confidence-meter">
                            <span class="confidence-label">Confidence</span>
                            <div class="confidence-bar">
                                <div class="confidence-fill" id="confidenceFill"></div>
                            </div>
                            <span class="confidence-value" id="confidenceValue">0%</span>
                        </div>
                    </div>
                    
                    <div class="findings" id="findings"></div>

                    <div class="action-buttons">
                        <button class="btn-secondary" id="saveBtn">Save to History</button>
                        <button class="btn-secondary" id="newCheckBtn">New Check</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Training View -->
        <section id="train-view" class="view">
            <div class="hero-section">
                <h1 class="glitch" data-text="Training Laboratory">Training Laboratory</h1>
                <p class="subtitle">Teach the AI to recognize installation issues</p>
            </div>

            <div class="training-grid">
                <div class="training-upload">
                    <h3>Upload Training Image</h3>
                    <div class="upload-zone small" id="trainingUploadZone">
                        <div class="upload-content">
                            <div class="upload-icon small">
                                <svg width="48" height="48" viewBox="0 0 64 64" fill="none">
                                    <path d="M32 10L32 40M32 10L22 20M32 10L42 20" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                                    <rect x="10" y="45" width="44" height="8" stroke="currentColor" stroke-width="3"/>
                                </svg>
                            </div>
                            <p>Drop image or click</p>
                            <input type="file" id="trainingFileInput" accept="image/*" hidden>
                        </div>
                    </div>
                </div>

                <div class="training-canvas-container" id="trainingCanvasContainer" style="display: none;">
                    <div class="canvas-wrapper">
                        <canvas id="trainingCanvas"></canvas>
                        <div class="annotation-tools">
                            <button class="tool-btn active" data-tool="box" title="Draw box">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <rect x="3" y="3" width="14" height="14" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                            </button>
                            <button class="tool-btn" data-tool="clear" title="Clear annotations">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M4 4L16 16M16 4L4 16" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="training-form">
                        <div class="form-group">
                            <label>Issue Classification</label>
                            <select id="issueType" class="form-control">
                                <option value="">Select issue type...</option>
                                <option value="improper-sealing">Improper Sealing</option>
                                <option value="cable-management">Poor Cable Management</option>
                                <option value="mounting-angle">Incorrect Mounting Angle</option>
                                <option value="clearance">Insufficient Clearance</option>
                                <option value="damage">Physical Damage</option>
                                <option value="weatherproofing">Inadequate Weatherproofing</option>
                                <option value="labeling">Missing/Incorrect Labeling</option>
                                <option value="grounding">Grounding Issues</option>
                                <option value="custom">Custom Issue</option>
                            </select>
                        </div>

                        <div class="form-group" id="customIssueGroup" style="display: none;">
                            <label>Custom Issue Name</label>
                            <input type="text" id="customIssue" class="form-control" placeholder="Enter custom issue name">
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="issueDescription" class="form-control" rows="3" placeholder="Describe what's wrong with this installation..."></textarea>
                        </div>

                        <div class="form-group">
                            <label>Severity</label>
                            <div class="severity-selector">
                                <button class="severity-btn" data-severity="low">Low</button>
                                <button class="severity-btn" data-severity="medium">Medium</button>
                                <button class="severity-btn" data-severity="high">High</button>
                                <button class="severity-btn" data-severity="critical">Critical</button>
                            </div>
                        </div>

                        <button class="btn-primary" id="submitTrainingBtn">
                            <span class="btn-text">Submit Training Data</span>
                            <span class="btn-loader"></span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="training-examples" id="trainingExamples">
                <h3>Recent Training Data</h3>
                <div class="examples-grid" id="examplesGrid">
                    <div class="empty-state">
                        <p>No training data yet. Upload images to get started.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- History View -->
        <section id="history-view" class="view">
            <div class="hero-section">
                <h1 class="glitch" data-text="Inspection History">Inspection History</h1>
                <p class="subtitle">Review past meter installation checks</p>
            </div>

            <div class="history-filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="pass">Passed</button>
                <button class="filter-btn" data-filter="fail">Failed</button>
            </div>

            <div class="history-grid" id="historyGrid">
                <div class="empty-state">
                    <p>No inspection history yet. Complete your first check to see it here.</p>
                </div>
            </div>
        </section>
    </main>

    <div class="toast" id="toast"></div>

    <script src="app.js"></script>
</body>
</html>
